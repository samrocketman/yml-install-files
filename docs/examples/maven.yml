versions:
  maven.tar.gz: 3.9.2
utility:
  maven.tar.gz:
    dest: /tmp
    # ignore the only condition if an upgrade is being performed
    only: '[ ! -e scratch/apache-maven ] || [ -n "${skip_checksum:-}" ]'
    download: https://dlcdn.apache.org/maven/maven-3/${version}/binaries/apache-maven-${version}-bin.tar.gz
    checksum_file: maven.sha256
    post_command: |
      # checksuming so skip post-download action
      if [ -n "${skip_checksum:-}" ]; then
        exit
      fi
      cd scratch
      tar -xzf /tmp/maven.tar.gz
      ln -s apache-maven-"${version}" apache-maven
      rm /tmp/maven.tar.gz
    update: |
      wget --quiet -O - https://dlcdn.apache.org/maven/maven-3 |
      awk '$0 ~ /href="[0-9.]+/ { print gensub(/.*href="([0-9.]*).*/, "\\1", "g") }' |
      sort -Vr | head -n1
